# Piscan Configuration Example

# Scanner settings
scanner:
  device: ""  # Auto-detect if empty, or specify like "canon_dr:libusb:001:002"
  resolution: 300  # DPI
  mode: "Color"  # Color, Gray, Lineart
  source: "Auto"  # Auto, ADF, Flatbed
  format: "png"  # png, jpeg, tiff
  color_correction: "swap_rb"  # Color channel correction: "none", "swap_rb" (swap red/blue), "swap_rg" (swap red/green), "swap_gb" (swap green/blue), "rotate_left" (RGB->GBR), "rotate_right" (RGB->BRG), "bgr_to_rgb"

# API settings
api:
  workspace: "difo"  # Workspace for API endpoint (e.g., "difo")
  url: "https://scan.haider.vc"  # Base API URL (without workspace path)
  token: ""  # Bearer token for authentication (your API key here)
  timeout: 60  # Request timeout in seconds

# Storage settings
storage:
  temp_dir: "/tmp"  # Base directory for temporary scan files
  failed_dir: "/tmp/failed"  # Directory for failed jobs
  keep_failed: true  # Whether to keep failed scan jobs
  temp_retention_hours: 168  # Delete temp scan dirs older than this (hours)
  failed_retention_days: 30  # Delete failed jobs older than this (days)

# Upload settings
upload:
  compression: "individual"  # Compression mode: "individual" (upload as separate files), "zip" (compress to ZIP before upload)
  image_quality: 90  # JPEG quality for compression (1-100, higher = better quality but larger file)
  optimize_png: true  # Optimize PNG files to reduce size
  zip_bundle_size: 6  # Max files per ZIP bundle (0 = unlimited). Splits large documents into multiple ZIPs (default: 6 pages)
  zip_bundle_max_bytes: 0  # Max ZIP payload bytes per bundle (0 = unlimited). Useful to avoid HTTP 413 (e.g. 50000000 for ~50MB)
  zip_compression_level: 6  # ZIP compression level (1-9, 9 = best compression but slower)
  auto_jpeg_threshold: 0  # Auto-convert to JPEG if page count exceeds this (0 = disabled). JPEG compresses better than PNG for photos
  auto_jpeg_page_size_bytes: 0  # Auto-convert pages larger than this to JPEG (0 = disabled)
  max_image_dimension: 0  # Max dimension for images (0 = unlimited). Reduces size by scaling down large images

# Processing settings
processing:
  skip_blank: true  # Whether to skip blank pages
  blank_threshold: 0.03  # Fraction of non-white pixels to consider page blank (3%)
  white_threshold: 250  # Pixel brightness > 250 considered white

# HTTP server settings
server:
  host: "0.0.0.0"  # Server bind address
  port: 5000  # Server port
  debug: false  # Debug mode

# Logging settings
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  file: "/var/log/piscan.log"  # Log file path
  max_size: 10485760  # Maximum log file size (10MB)
  backup_count: 5  # Number of log backups to keep

# Sound notifications
sound:
  enabled: true  # Enable sound notifications
  success_sound: "/opt/piscan/sounds/ds9_shuttle_beep.mp3"  # Sound file for successful upload
  error_sound: "/opt/piscan/sounds/computer_error.mp3"  # Sound file for errors
  volume: 70  # Volume percentage (0-100)
  device: ""  # Optional ALSA device for aplay (e.g. "plughw:1,0" for USB soundbar)